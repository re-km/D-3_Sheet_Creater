# D-3 Sheet Creater (様式D-3 自動作成ツール)

指定されたExcelファイル（`xxxxx_A.xlsx`）のデータ量に基づいて、テンプレートファイル（`xxxxx_D-3.xlsm`）にシートを自動追加し、データを転記するためのPythonツールです。
Excelアドイン「様式D-3シート追加」ボタンを自動操作することで、大量のシート作成を効率化します。

## 機能

1. **動的なファイル検出**:
   - 実行フォルダ内にある `[5桁の数字]_D-3.xlsm` を自動検出します。
   - 対応する `[5桁の数字]_A.xlsx` を自動検出します。

2. **シート自動作成**:
   - `A.xlsx` の「様式A-2」シート（B9セル以降）のデータ行数をカウントします。
   - 行数分だけ、Excelアドインの「様式D-3シート追加」ボタンを自動で繰り返し実行します。

3. **データ転記**:
   - `A.xlsx` のB列・C列のデータを読み取ります。
   - 作成された各シート（`様式D-3-x`）の `M7` および `Q7` セルにデータを転記します。

4. **安全設計**:
   - Excelが起動していない場合や、対象ファイルが開かれていない場合は警告を出して停止し、誤動作を防ぎます。

## 必要要件

- Windows OS
- Microsoft Excel (マクロ/アドインが動作する環境)
- Python 3.x
- 必要なPythonライブラリ:
  - `pywin32` (`pip install pywin32`)

## 使い方

### 準備

1. 以下のファイルを同じフォルダに配置してください。
   - `addin_clicker.py` (本スクリプト)
   - `run_sheet_creater.bat` (実行用バッチファイル)
   - 対象の `xxxxx_D-3.xlsm` ファイル
   - データの入った `xxxxx_A.xlsx` ファイル

2. **Excelを手動で起動し、`xxxxx_D-3.xlsm` を開いてください。**
   - アドインが有効になっていることを確認してください。

### 実行

1. `run_sheet_creater.bat` をダブルクリックして実行します。
2. コマンドプロンプトが立ち上がり、自動処理が開始されます。
   - 処理中はマウスやキーボード操作を控えてください。
3. 「処理が終了しました」と表示されたら完了です。任意のキーを押してウィンドウを閉じてください。

## 注意事項

- 本ツールはGUIオートメーション（COM操作）を使用しています。実行中はExcelのアクティブウィンドウが操作されます。
- `A.xlsx` は読み取り専用で開かれますが、念のためバックアップを取ってからの実行を推奨します。

## 構成ファイル

- `addin_clicker.py`: メイン処理を行うPythonスクリプト
- `run_sheet_creater.bat`: スクリプトを簡単に実行するためのバッチファイル
